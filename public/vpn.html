<!DOCTYPE html>
<html>
<head>
  <title>ğŸ‡ºğŸ‡¸ğŸ‡¬ğŸ‡§ Residential VPN</title>
  <style>
    body{background:linear-gradient(45deg,#000,#111,#000);color:#0f0;font-family:monospace;padding:2rem;max-width:1200px;margin:auto}
    button{padding:20px 40px;margin:15px;font-size:18px;background:#0f0;color:#000;border:none;border-radius:12px;cursor:pointer;font-weight:bold;transition:all.3s}
    button:hover{transform:scale(1.08);box-shadow:0 0 30px #0f0}
    #vpn-status{padding:25px;background:#0a0;border-radius:15px;margin:30px 0;font-size:20px}
    #result{background:#111;padding:30px;border-radius:15px;max-height:600px;overflow:auto;border:2px solid #333;white-space:pre-wrap;font-size:14px}
    .ip-badge{background:#0f0;color:#000;padding:15px 25px;border-radius:30px;font-size:22px;font-weight:bold;display:inline-block;margin:15px}
    input,select{padding:20px;margin:15px;border:2px solid #0f0;background:#000;color:#0f0;font-size:18px;border-radius:10px;width:100%;max-width:500px}
    h1{font-size:4em;text-align:center;margin:30px 0;text-shadow:0 0 40px #0f0;letter-spacing:5px}
    .vpn-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:25px;margin:40px 0}
  </style>
</head>
<body>
  <h1>ğŸ  Residential VPN</h1>
  
  <div id="vpn-status">ğŸ”„ Connecting VPN...</div>
  
  <div class="vpn-grid">
    <button onclick="vpnNY()">ğŸ‡ºğŸ‡¸ NEW YORK VPN</button>
    <button onclick="vpnUK()">ğŸ‡¬ğŸ‡§ LONDON VPN</button>
    <button onclick="testIP()">ğŸŒ CHECK IP</button>
    <button onclick="testAds()">ğŸ“º TEST ADS</button>
  </div>

  <div style="text-align:center;margin:40px 0">
    <input id="customUrl" value="https://ipinfo.io/json" placeholder="Any Website URL">
    <select id="vpnLocation">
      <option value="newyork">ğŸ‡ºğŸ‡¸ New York Residential</option>
      <option value="london">ğŸ‡¬ğŸ‡§ London Residential</option>
    </select>
    <br><button onclick="vpnCustom()" style="padding:25px 60px;font-size:20px">ğŸš€ CONNECT VPN</button>
  </div>

  <div id="result">Click VPN button to tunnel through residential proxy...</div>

  <script>
    const VPN_BASE = '/api/vpn';

    async function requestVPN(url, location) {
      const controller = new AbortController();
      const timeout = setTimeout(() => controller.abort(), 15000);
      
      try {
        const res = await fetch(`${VPN_BASE}?url=${encodeURIComponent(url)}&location=${location}`, {
          signal: controller.signal
        });
        clearTimeout(timeout);
        return await res.text();
      } catch(e) {
        clearTimeout(timeout);
        throw e;
      }
    }

    async function vpnNY() { await vpnTest('https://ipinfo.io/json', 'newyork'); }
    async function vpnUK() { await vpnTest('https://ipinfo.io/json', 'london'); }
    async function testIP() { await vpnTest('https://httpbin.org/ip', document.getElementById('vpnLocation').value); }
    async function testAds() { await vpnTest('https://whoer.net', 'newyork'); }
    
    async function vpnCustom() {
      const url = document.getElementById('customUrl').value;
      const loc = document.getElementById('vpnLocation').value;
      await vpnTest(url, loc);
    }

    async function vpnTest(url, location) {
      try {
        document.getElementById('vpn-status').innerHTML = `ğŸ”„ VPN ${location.toUpperCase()} â†’ ${url}`;
        document.getElementById('vpn-status').style.background = '#ff0';
        
        const result = await requestVPN(url, location);
        document.getElementById('result').textContent = result;
        
        // Highlight IP
        const ipMatch = result.match(/"ip":\s*"([^"]+)"/) || result.match(/Your IP:?\s*([^\s<]+)/i);
        if (ipMatch) {
          const ip = ipMatch[1];
          document.getElementById('result').innerHTML = result.replace(
            new RegExp(ip, 'g'), `<span class="ip-badge">${ip}</span>`
          );
          document.getElementById('vpn-status').innerHTML = `âœ… VPN ACTIVE: ${ip} (${location.toUpperCase()})`;
          document.getElementById('vpn-status').style.background = '#0f0';
        }
        
      } catch(error) {
        document.getElementById('result').textContent = `âŒ VPN Error: ${error.message}`;
        document.getElementById('vpn-status').innerHTML = 'âŒ VPN Failed';
        document.getElementById('vpn-status').style.background = '#f00';
      }
    }

    // Auto test
    window.onload = () => setTimeout(() => testIP(), 1000);
  </script>
</body>
</html>
